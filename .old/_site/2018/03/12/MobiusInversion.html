<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">

<!-- Begin Jekyll SEO tag v2.4.0 -->
<title>莫比乌斯反演学习笔记 | Panda_2134’s Blog</title>
<meta name="generator" content="Jekyll v3.6.2" />
<meta property="og:title" content="莫比乌斯反演学习笔记" />
<meta name="author" content="panda_2134" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="莫比乌斯函数 我们定义 ​ 为什么这么定义?为了满足性质: ​ 下面我们来证明上式. ​ 当 时显然成立. ​ 当 时,不妨设 . 的恰含有 个互异质因数的因子有 个.当它含有奇数个互异质因子时, 对答案贡献为 , 含偶数个互异质因子时贡献为 .于是总的贡献为: ​ 得证. ​ 从上面的证明过程可以看出, 其实莫比乌斯函数就是在模拟容斥原理, 不过容斥的对象是唯一分解式中的指数罢了. 把不同的质因数看成盒子, 指数看成球, 就转为了经典的球-盒模型. 莫比乌斯反演 形式1:枚举约数 证明: ​ ⇒: ​ ⇐: ​ 得证. ​ 形式2:枚举倍数 这个形式比较常用. ​ 我们不妨假设 . 则: ​ 这个比较难证明……想了好久…… ​ 证明: ​ ⇒: ​ ⇐: ​ 得证. 一点重要的结论 证明1：利用法里级数 这是《具体数学》的证明方法。名字很玄乎，其实很直观。 我们考察以 为底的所有真分数和1一起组成的集合。不妨假设 . 则这些分数是： 化简后就变成了： 按照分母分个组： 分母里面出现了 的每个约数 . 对于每个约数 对应的分组，分子上出现了 个小于等于 且与之互质的数。总共又有 个分数。也就是说所有约数的 之和就是 . 写成式子就是上式。得证。 证明2：利用 函数的性质，构造出 ，再使用莫比乌斯反演消去（%Anoxiacxy） QED. 例题 BZOJ2301 [HAOI2011]Problem b 莫比乌斯反演+数论分块，达到单组询问 ​的复杂度。 参考链接: 强烈推荐:PoPoQQQ的PPT 莫比乌斯反演定理证明" />
<meta property="og:description" content="莫比乌斯函数 我们定义 ​ 为什么这么定义?为了满足性质: ​ 下面我们来证明上式. ​ 当 时显然成立. ​ 当 时,不妨设 . 的恰含有 个互异质因数的因子有 个.当它含有奇数个互异质因子时, 对答案贡献为 , 含偶数个互异质因子时贡献为 .于是总的贡献为: ​ 得证. ​ 从上面的证明过程可以看出, 其实莫比乌斯函数就是在模拟容斥原理, 不过容斥的对象是唯一分解式中的指数罢了. 把不同的质因数看成盒子, 指数看成球, 就转为了经典的球-盒模型. 莫比乌斯反演 形式1:枚举约数 证明: ​ ⇒: ​ ⇐: ​ 得证. ​ 形式2:枚举倍数 这个形式比较常用. ​ 我们不妨假设 . 则: ​ 这个比较难证明……想了好久…… ​ 证明: ​ ⇒: ​ ⇐: ​ 得证. 一点重要的结论 证明1：利用法里级数 这是《具体数学》的证明方法。名字很玄乎，其实很直观。 我们考察以 为底的所有真分数和1一起组成的集合。不妨假设 . 则这些分数是： 化简后就变成了： 按照分母分个组： 分母里面出现了 的每个约数 . 对于每个约数 对应的分组，分子上出现了 个小于等于 且与之互质的数。总共又有 个分数。也就是说所有约数的 之和就是 . 写成式子就是上式。得证。 证明2：利用 函数的性质，构造出 ，再使用莫比乌斯反演消去（%Anoxiacxy） QED. 例题 BZOJ2301 [HAOI2011]Problem b 莫比乌斯反演+数论分块，达到单组询问 ​的复杂度。 参考链接: 强烈推荐:PoPoQQQ的PPT 莫比乌斯反演定理证明" />
<link rel="canonical" href="http://localhost:4000/2018/03/12/MobiusInversion" />
<meta property="og:url" content="http://localhost:4000/2018/03/12/MobiusInversion" />
<meta property="og:site_name" content="Panda_2134’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-03-12T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"莫比乌斯函数 我们定义 ​ 为什么这么定义?为了满足性质: ​ 下面我们来证明上式. ​ 当 时显然成立. ​ 当 时,不妨设 . 的恰含有 个互异质因数的因子有 个.当它含有奇数个互异质因子时, 对答案贡献为 , 含偶数个互异质因子时贡献为 .于是总的贡献为: ​ 得证. ​ 从上面的证明过程可以看出, 其实莫比乌斯函数就是在模拟容斥原理, 不过容斥的对象是唯一分解式中的指数罢了. 把不同的质因数看成盒子, 指数看成球, 就转为了经典的球-盒模型. 莫比乌斯反演 形式1:枚举约数 证明: ​ ⇒: ​ ⇐: ​ 得证. ​ 形式2:枚举倍数 这个形式比较常用. ​ 我们不妨假设 . 则: ​ 这个比较难证明……想了好久…… ​ 证明: ​ ⇒: ​ ⇐: ​ 得证. 一点重要的结论 证明1：利用法里级数 这是《具体数学》的证明方法。名字很玄乎，其实很直观。 我们考察以 为底的所有真分数和1一起组成的集合。不妨假设 . 则这些分数是： 化简后就变成了： 按照分母分个组： 分母里面出现了 的每个约数 . 对于每个约数 对应的分组，分子上出现了 个小于等于 且与之互质的数。总共又有 个分数。也就是说所有约数的 之和就是 . 写成式子就是上式。得证。 证明2：利用 函数的性质，构造出 ，再使用莫比乌斯反演消去（%Anoxiacxy） QED. 例题 BZOJ2301 [HAOI2011]Problem b 莫比乌斯反演+数论分块，达到单组询问 ​的复杂度。 参考链接: 强烈推荐:PoPoQQQ的PPT 莫比乌斯反演定理证明","author":{"@type":"Person","name":"panda_2134"},"@type":"BlogPosting","url":"http://localhost:4000/2018/03/12/MobiusInversion","headline":"莫比乌斯反演学习笔记","dateModified":"2018-03-12T00:00:00+08:00","datePublished":"2018-03-12T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2018/03/12/MobiusInversion"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="description" content="Stay Hungry,Stay Stupid"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/assets/css/style.css?v=ca581cfac24950b4053aaad38e9a666f577b9d12">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Panda_2134's Blog</h1>
      <h2 class="project-tagline">Stay Hungry,Stay Stupid</h2>
      
        <a href="http://github.com/panda2134/panda2134.github.io" class="btn">View on GitHub</a>
      
      
    </section>

    <section class="main-content">
      <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  	jax: ["input/TeX", "output/HTML-CSS"],
    "HTML-CSS": { webFont: "Neo-Euler" }
  });
</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<style>
	@font-face{
		font-family:"PTsans";
		src:url("/assets/font/PTsans.ttf");
		font-size: 20px;
	}
	@font-face{
		font-family:"SourceCodePro";
		src:url("/assets/font/SourceCodePro-Regular.ttf");
		font-size: 20px;
	}
	div.postpg {
		font-family:'PTsans','Microsoft Yahei Light','Microsoft Yahei','simsun',sans-serif;
		width: 750px;
		margin-left: 5rem;
		margin-right: 4rem;
		font-size: 20px;
	}
	.code{
		font-family:'SourceCodePro' !important;
		font-size: 20px !important;
	}
	code{
		font-family:'SourceCodePro' !important;
		font-size: 20px !important;
	}
</style>


<div class="postpg">
<p>
	<a href="/"> << Back to Index </a>
</p>

<h2>莫比乌斯反演学习笔记</h2>
<div id="post">
	<span style="color:#159957">In Categories:</span>
	
    	<span>笔记</span>
    

    <br/>
    <span style="color:#159957">In Tags:</span>
    
    	<span>数论  莫比乌斯反演</span>
    
	<p>
    	<h2 id="莫比乌斯函数">莫比乌斯函数</h2>

<p>我们定义  <br />
​            <br />
<script type="math/tex">% <![CDATA[
\begin{equation}
\mu(n) = \begin{cases}
	1 & \text{当} n = 1 \\
	(-1)^k & \text{当}n \text{为} k \text{个互异质数的积} \\
	0 & \text{当} n \text{某个质因子次数大于等于} 2
\end{cases}
\end{equation} \label{mobius-func} %]]></script></p>

<p>为什么这么定义?为了满足性质:    <br />
​               <br />
<script type="math/tex">\begin{equation} \sum_{d \backslash n} \mu (d) = [n = 1] \end{equation}</script></p>

<p>下面我们来证明上式.   <br />
​         <br />
当 <script type="math/tex">n = 1</script> 时显然成立.    <br />
​           <br />
当 <script type="math/tex">n \ge 2</script> 时,不妨设 <script type="math/tex">n = \prod_{i=1}^k p_i^{\alpha_i}</script>.  <script type="math/tex">n</script> 的恰含有 <script type="math/tex">r</script> 个互异质因数的因子有<script type="math/tex">\binom{k}{r}</script> 个.当它含有奇数个互异质因子时, 对答案贡献为 <script type="math/tex">-1</script> , 含偶数个互异质因子时贡献为 <script type="math/tex">1</script> .于是总的贡献为:         <br />
​            <br />
<script type="math/tex">% <![CDATA[
\begin{align*}
\sum_{d \backslash n} \mu (d) &= \binom{n}{0} - \binom{n}{1} + \binom{n}{2}- \cdots \\
&= \sum_{i=0}^k (-1)^i \binom{n}{i} \\
&= (1 - 1)^k \\
&= 0
\end{align*} %]]></script></p>

<p>得证.  <br />
​            <br />
从上面的证明过程可以看出, 其实莫比乌斯函数就是在模拟容斥原理, 不过容斥的对象是唯一分解式中的指数罢了. 把不同的质因数看成盒子, 指数看成球, 就转为了经典的球-盒模型.</p>

<h2 id="莫比乌斯反演">莫比乌斯反演</h2>

<h3 id="形式1枚举约数">形式1:枚举约数</h3>

<script type="math/tex; mode=display">\begin{align}
F(n) = \sum_{d \backslash n} f(d) \Leftrightarrow f(n) = \sum_{d \backslash n} \mu(d) F(\frac{n}{d}) \\
\end{align}</script>

<p>证明:     <br />
​                <br />
⇒:      <br />
​          <br />
<script type="math/tex">% <![CDATA[
\begin{align*}
	\sum_{d \backslash n} \mu(d) F(\frac{n}{d})	&= \sum_{d \backslash n} \mu(d) \sum_{k \backslash (n/d)} f(k) \\
	&= \sum_{d \backslash n} \sum_{k \backslash (n/d)} \mu(d) f(k) \\
	&= \sum_{k \backslash n} \sum_{d \backslash (n/k)} \mu(d) f(k) \\
	&= \sum_{k \backslash n} f(k) \sum_{d \backslash (n/k)} \mu(d) \\
	&= \sum_{k \backslash n} f(k) [n = k] \\
	&= f(n)
	\end{align*} %]]></script></p>

<p>⇐:  <br />
​         <br />
<script type="math/tex">% <![CDATA[
\begin{align*}
	\sum_{d \backslash n} f(d) &= \sum_{d \backslash n} \sum_{k \backslash d} \mu(k) F(\frac{d}{k}) \\
	&= \sum_{p \backslash n} \sum_{q \backslash (n/p)} \mu(p) F(q) \tag{Rocky Road方法}\\
	&= \sum_{q \backslash n} \sum_{p \backslash (n/q)} \mu(p) F(q) \\
	&= \sum_{q \backslash n} F(q) \sum_{p \backslash (n/q)} \mu(p) \\
	&= \sum_{q \backslash n} F(q) [n = q] \\
	&= F(n)
	\end{align*} %]]></script></p>

<p>得证.        <br />
​</p>
<h3 id="形式2枚举倍数">形式2:枚举倍数</h3>

<p>这个形式比较常用.         <br />
​            <br />
我们不妨假设 <script type="math/tex">n, d \le N</script> . 则:<br />
​            <br />
<script type="math/tex">F(n) = \sum_{n \backslash d}f(d) \Leftrightarrow f(n) = \sum_{n \backslash d} \mu(\frac{d}{n})F(d)</script></p>

<p>这个比较难证明……想了好久……          <br />
​           <br />
证明:          <br />
​                <br />
⇒:                      <br />
​              <br />
<script type="math/tex">% <![CDATA[
\begin{align*}
\sum_{n \backslash d} \mu(\frac{d}{n}) F(d) &= \sum_{k=1}^{+\infty}  \mu(k) F(nk) \\
&= \sum_{k=1}^{+\infty}\mu(k)\sum_{nk \backslash t} f(t) \\
&= \sum_{n \backslash t} f(t) \sum_{k \backslash (t / n)} \mu(k) \\
&= \sum_{n \backslash t} f(t) [t = n] \\
&= f(t)
\end{align*} %]]></script></p>

<p>⇐:          <br />
​                 <br />
<script type="math/tex">% <![CDATA[
\begin{align*}
	\sum_{n \backslash d} f(d)  &= \sum_{k=1}^{+\infty}f(nk) \\
	&= \sum_{k=1}^{+\infty} \sum_{nk \backslash m} \mu(\frac{m}{nk}) F(m) \\	
	&= \sum_{k=1}^{+\infty} \sum_{t=1}^{+\infty} \mu(t) F(nkt) \\	
	&= \sum_{t=1}^{+\infty} \mu(t) \sum_{k=1}^{+\infty} F(nkt) \\
	&= \sum_{k=1}^{+\infty} F(nk) \left(\sum_{p \backslash k} \mu(p)\right) \\
	&= \sum_{k=1}^{+\infty} F(nk) [k = 1] \\
	&= F(n)
	\end{align*} %]]></script></p>

<p>得证.</p>

<h2 id="一点重要的结论">一点重要的结论</h2>

<script type="math/tex; mode=display">n = \sum_{d \backslash n}\varphi(d)   \tag{欧拉函数的狄利克雷前缀和}</script>

<p>证明1：利用法里级数  <br />
这是《具体数学》的证明方法。名字很玄乎，其实很直观。</p>

<p>我们考察以 <script type="math/tex">n</script> 为底的所有真分数和1一起组成的集合。不妨假设 <script type="math/tex">n=12</script> . 则这些分数是：  <br />
<script type="math/tex">\frac{1}{12}, \frac{2}{12}, \frac{3}{12}, \frac{4}{12}, \frac{5}{12}, \frac{6}{12}, \frac{7}{12}, \frac{8}{12}, \frac{9}{12}, \frac{10}{12}, \frac{11}{12}, \frac{12}{12}</script>
化简后就变成了：    <br />
<script type="math/tex">\frac{1}{12},\frac{1}{6},\frac{1}{4},\frac{1}{3}, \frac{5}{12}, \frac{1}{2}, \frac{7}{12}, \frac{2}{3}, \frac{3}{4}, \frac{5}{6}, \frac{11}{12}, \frac{1}{1}</script>
按照分母分个组：  <br />
<script type="math/tex">\left(\frac{1}{1}\right),\left(\frac{1}{2}\right), \left(\frac{1}{3}, \frac{2}{3}\right), \left(\frac{4}{1}, \frac{4}{3}\right), \left(\frac{1}{6}, \frac{5}{6}\right),\left( \frac{1}{12}, \frac{5}{12}, \frac{7}{12}, \frac{11}{12}\right)</script>
分母里面出现了 <script type="math/tex">n</script> 的每个约数 <script type="math/tex">d</script> . 对于每个约数 <script type="math/tex">d</script> 对应的分组，分子上出现了 <script type="math/tex">\varphi(d)</script> 个小于等于 <script type="math/tex">d</script> 且与之互质的数。总共又有 <script type="math/tex">n</script> 个分数。也就是说所有约数的 <script type="math/tex">\varphi(n)</script> 之和就是 <script type="math/tex">n</script> . 写成式子就是上式。得证。</p>

<p>证明2：利用 <script type="math/tex">\mu</script> 函数的性质，构造出 <script type="math/tex">\mu(n)</script> ，再使用莫比乌斯反演消去（%Anoxiacxy）
<script type="math/tex">% <![CDATA[
\begin{align*}
\varphi(n) &= \sum_{1 \le i \le n} [i \perp n] \\
&= \sum_{1 \le i \le n} \sum_{d  \backslash \text{gcd}(i, n)} \mu(d) \\
&= \sum_{d \backslash n} \sum_{1 \le i \le n} \mu(d) [d \backslash i] \\
&= \sum_{d \backslash n} \mu(d) \frac{n}{d} \\
&\Rightarrow n = \sum_{d \backslash n} \varphi(n)
\end{align*} %]]></script>
QED.</p>

<h2 id="例题">例题</h2>

<ul>
  <li>BZOJ2301 [HAOI2011]Problem b</li>
  <li>莫比乌斯反演+数论分块，达到单组询问 <script type="math/tex">O(\sqrt{n})</script> ​的复杂度。</li>
</ul>

<hr />

<p>参考链接:</p>

<p><strong>强烈推荐:</strong><a href="https://wenku.baidu.com/view/fbec9c63ba1aa8114431d9ac.html">PoPoQQQ的PPT</a></p>

<p><a href="http://blog.csdn.net/outer_form/article/details/50588307">莫比乌斯反演定理证明</a></p>


	</p>
</div>
<div id="related">
    <h3>Related Posts:</h3>
    <ul class="posts" style="margin:0px; padding:0px;">
        
    		<li><a href="/2018/03/17/ISAP">ISAP算法学习笔记</a></li>
  	  	
    		<li><a href="/2018/03/15/walk">[HNOI2013]游走</a></li>
  	  	
    		<li><a href="/2018/03/14/greeting">[六省联考2017]相逢是问候</a></li>
  	  	
    </ul>
</div>
<div id="comment">
     
	<h3>Comments:</h3>
<div id="comm1"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
var gitment = new Gitment({
  id: '/2018/03/12/MobiusInversion',
  owner: 'panda2134',
  repo: 'panda2134.github.io',
  oauth: {
    client_id: '9107291a3086ed30c48f',
    client_secret: 'aaa7ae9353eca07778c747e5641ffa81c5c24e8d',
  },
});
gitment.render('comm1');
</script>
	<noscript>Please enable JavaScript to view the comments.</noscript>
	
</div>
</div>


      <footer class="site-footer">
        
          <span class="site-footer-owner"><a href="http://github.com/panda2134/panda2134.github.io">panda2134.github.io</a> is maintained by <a href="http://github.com/panda2134">panda2134</a>.</span>
        
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
      </footer>
    </section>

    
  </body>
</html>
