<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">

<!-- Begin Jekyll SEO tag v2.4.0 -->
<title>[六省联考2017]分手是祝愿 | Panda_2134’s Blog</title>
<meta name="generator" content="Jekyll v3.6.2" />
<meta property="og:title" content="[六省联考2017]分手是祝愿" />
<meta name="author" content="panda_2134" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="上午做了六省联考2017 Day2. 挂的一塌糊涂，除了某个做过的题 A 了之外其他题目加起来只有55. 这个题目的贪心都没想到。 cxy神犇接近AK。 技不如人， 如果不多刷题的话， 可能只有失败的后果吧。 现在也不要想别的了，挂了就是自己弱， 没别的。 就是自己弱。太弱了，就没有大学上了。 去除杂念， 专心刷题， 才有可能超越啊。 思路 我们考虑50分的情况。 对于50%的数据, 满足 . , 说明求期望变成了求最小步数。打个暴力可以发现, 最小步数一定小于 . 为什么呢? 我们考虑构造一个方案来达到最小的步数。每个数的约数小于等于它本身，于是我们贪心地从右边往左边扫，每次碰到一个亮着的灯就按按钮。我们注意到，由于异或的定义，每个按钮最多按一次。所以总次数小于 ， 一定是可行解。如何证明其最优性？如果某个灯本来是亮的，可以分2种情况。由于它必须最后被按灭，要么它在扫到它之前就灭了，要么它在扫到它的时候被按灭。前者说明一次按灭了大于等于2个灯，贪心的答案不会更坏。后者也不会使得答案劣于最优解。如果某个灯是灭的，在按比它编号大的按钮的时候被点亮，我们可以发现，按比它编号大的按钮，一定是由于那个灯是亮的，因此不得不按。最优解不可能比当前贪心策略更好。 这种贪心实际上可以得到80分。 以上都还没有涉及到期望。我们现在来加入 的情况，这就需要建立期望的递推关系。 真的需要把当前的状态塞进期望递推式吗？动态规划和递推的状态设计，要看转移的需要。如果转移不需要完整的局面，就没必要把完整的局面塞进递推。显然，如果设每个开关 至少还需要按的次数为 ，那么一定有 . 考虑当前全部开关加起来还需要按 次才能清零。这可以看做有 个 1 装在 个盒子里面，其他的盒子为空。任意取走某一个 1 ，此后的步数减少 1 ；往没有 1 的盒子里面放一个 1 ，此后的步数增加 1. 可以看出，转移只和全部开关加起来要按的次数有关。 设 表示当前还有 个 1 的情况下期望按多少次能全部按成0.此处的 就是刚才的 . 于是： ​ 这可以高斯消元求解。但是 ，时间无法承受。 《训练指南》上面的 2 个关于马尔科夫过程的题，一个是高斯消元法，一个是手动消元。这里是不是可以手动消元呢？想想数学课上，学数列的时候，遇到这种式子常常移项差分。试一试： ​ 就可以一个一个递推了。 边界的处理？ 是不符合递推式的断点，怎么办？ 换一边来推！ 结合 这一结论（所有盒子里面都有 1 ，任意摸一个都可以减少一步），又有 ，可以得出答案。 疑问：题中给出的状态，不一定可达 ，为何可以这么递推？ 好像想通了…… 只是递推的起点，我们要根据初始状态的最少步数来确定取 的哪一项。 考虑差分出的 的组合意义：从剩下 步到 步的期望操作数目。" />
<meta property="og:description" content="上午做了六省联考2017 Day2. 挂的一塌糊涂，除了某个做过的题 A 了之外其他题目加起来只有55. 这个题目的贪心都没想到。 cxy神犇接近AK。 技不如人， 如果不多刷题的话， 可能只有失败的后果吧。 现在也不要想别的了，挂了就是自己弱， 没别的。 就是自己弱。太弱了，就没有大学上了。 去除杂念， 专心刷题， 才有可能超越啊。 思路 我们考虑50分的情况。 对于50%的数据, 满足 . , 说明求期望变成了求最小步数。打个暴力可以发现, 最小步数一定小于 . 为什么呢? 我们考虑构造一个方案来达到最小的步数。每个数的约数小于等于它本身，于是我们贪心地从右边往左边扫，每次碰到一个亮着的灯就按按钮。我们注意到，由于异或的定义，每个按钮最多按一次。所以总次数小于 ， 一定是可行解。如何证明其最优性？如果某个灯本来是亮的，可以分2种情况。由于它必须最后被按灭，要么它在扫到它之前就灭了，要么它在扫到它的时候被按灭。前者说明一次按灭了大于等于2个灯，贪心的答案不会更坏。后者也不会使得答案劣于最优解。如果某个灯是灭的，在按比它编号大的按钮的时候被点亮，我们可以发现，按比它编号大的按钮，一定是由于那个灯是亮的，因此不得不按。最优解不可能比当前贪心策略更好。 这种贪心实际上可以得到80分。 以上都还没有涉及到期望。我们现在来加入 的情况，这就需要建立期望的递推关系。 真的需要把当前的状态塞进期望递推式吗？动态规划和递推的状态设计，要看转移的需要。如果转移不需要完整的局面，就没必要把完整的局面塞进递推。显然，如果设每个开关 至少还需要按的次数为 ，那么一定有 . 考虑当前全部开关加起来还需要按 次才能清零。这可以看做有 个 1 装在 个盒子里面，其他的盒子为空。任意取走某一个 1 ，此后的步数减少 1 ；往没有 1 的盒子里面放一个 1 ，此后的步数增加 1. 可以看出，转移只和全部开关加起来要按的次数有关。 设 表示当前还有 个 1 的情况下期望按多少次能全部按成0.此处的 就是刚才的 . 于是： ​ 这可以高斯消元求解。但是 ，时间无法承受。 《训练指南》上面的 2 个关于马尔科夫过程的题，一个是高斯消元法，一个是手动消元。这里是不是可以手动消元呢？想想数学课上，学数列的时候，遇到这种式子常常移项差分。试一试： ​ 就可以一个一个递推了。 边界的处理？ 是不符合递推式的断点，怎么办？ 换一边来推！ 结合 这一结论（所有盒子里面都有 1 ，任意摸一个都可以减少一步），又有 ，可以得出答案。 疑问：题中给出的状态，不一定可达 ，为何可以这么递推？ 好像想通了…… 只是递推的起点，我们要根据初始状态的最少步数来确定取 的哪一项。 考虑差分出的 的组合意义：从剩下 步到 步的期望操作数目。" />
<link rel="canonical" href="http://localhost:4000/2018/03/13/wish" />
<meta property="og:url" content="http://localhost:4000/2018/03/13/wish" />
<meta property="og:site_name" content="Panda_2134’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-03-13T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"上午做了六省联考2017 Day2. 挂的一塌糊涂，除了某个做过的题 A 了之外其他题目加起来只有55. 这个题目的贪心都没想到。 cxy神犇接近AK。 技不如人， 如果不多刷题的话， 可能只有失败的后果吧。 现在也不要想别的了，挂了就是自己弱， 没别的。 就是自己弱。太弱了，就没有大学上了。 去除杂念， 专心刷题， 才有可能超越啊。 思路 我们考虑50分的情况。 对于50%的数据, 满足 . , 说明求期望变成了求最小步数。打个暴力可以发现, 最小步数一定小于 . 为什么呢? 我们考虑构造一个方案来达到最小的步数。每个数的约数小于等于它本身，于是我们贪心地从右边往左边扫，每次碰到一个亮着的灯就按按钮。我们注意到，由于异或的定义，每个按钮最多按一次。所以总次数小于 ， 一定是可行解。如何证明其最优性？如果某个灯本来是亮的，可以分2种情况。由于它必须最后被按灭，要么它在扫到它之前就灭了，要么它在扫到它的时候被按灭。前者说明一次按灭了大于等于2个灯，贪心的答案不会更坏。后者也不会使得答案劣于最优解。如果某个灯是灭的，在按比它编号大的按钮的时候被点亮，我们可以发现，按比它编号大的按钮，一定是由于那个灯是亮的，因此不得不按。最优解不可能比当前贪心策略更好。 这种贪心实际上可以得到80分。 以上都还没有涉及到期望。我们现在来加入 的情况，这就需要建立期望的递推关系。 真的需要把当前的状态塞进期望递推式吗？动态规划和递推的状态设计，要看转移的需要。如果转移不需要完整的局面，就没必要把完整的局面塞进递推。显然，如果设每个开关 至少还需要按的次数为 ，那么一定有 . 考虑当前全部开关加起来还需要按 次才能清零。这可以看做有 个 1 装在 个盒子里面，其他的盒子为空。任意取走某一个 1 ，此后的步数减少 1 ；往没有 1 的盒子里面放一个 1 ，此后的步数增加 1. 可以看出，转移只和全部开关加起来要按的次数有关。 设 表示当前还有 个 1 的情况下期望按多少次能全部按成0.此处的 就是刚才的 . 于是： ​ 这可以高斯消元求解。但是 ，时间无法承受。 《训练指南》上面的 2 个关于马尔科夫过程的题，一个是高斯消元法，一个是手动消元。这里是不是可以手动消元呢？想想数学课上，学数列的时候，遇到这种式子常常移项差分。试一试： ​ 就可以一个一个递推了。 边界的处理？ 是不符合递推式的断点，怎么办？ 换一边来推！ 结合 这一结论（所有盒子里面都有 1 ，任意摸一个都可以减少一步），又有 ，可以得出答案。 疑问：题中给出的状态，不一定可达 ，为何可以这么递推？ 好像想通了…… 只是递推的起点，我们要根据初始状态的最少步数来确定取 的哪一项。 考虑差分出的 的组合意义：从剩下 步到 步的期望操作数目。","author":{"@type":"Person","name":"panda_2134"},"@type":"BlogPosting","url":"http://localhost:4000/2018/03/13/wish","headline":"[六省联考2017]分手是祝愿","dateModified":"2018-03-13T00:00:00+08:00","datePublished":"2018-03-13T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2018/03/13/wish"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="description" content="Stay Hungry,Stay Stupid"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/assets/css/style.css?v=ca581cfac24950b4053aaad38e9a666f577b9d12">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Panda_2134's Blog</h1>
      <h2 class="project-tagline">Stay Hungry,Stay Stupid</h2>
      
        <a href="http://github.com/panda2134/panda2134.github.io" class="btn">View on GitHub</a>
      
      
    </section>

    <section class="main-content">
      <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  	jax: ["input/TeX", "output/HTML-CSS"],
    "HTML-CSS": { webFont: "Neo-Euler" }
  });
</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<style>
	@font-face{
		font-family:"PTsans";
		src:url("/assets/font/PTsans.ttf");
		font-size: 20px;
	}
	@font-face{
		font-family:"SourceCodePro";
		src:url("/assets/font/SourceCodePro-Regular.ttf");
		font-size: 20px;
	}
	div.postpg {
		font-family:'PTsans','Microsoft Yahei Light','Microsoft Yahei','simsun',sans-serif;
		width: 750px;
		margin-left: 5rem;
		margin-right: 4rem;
		font-size: 20px;
	}
	.code{
		font-family:'SourceCodePro' !important;
		font-size: 20px !important;
	}
	code{
		font-family:'SourceCodePro' !important;
		font-size: 20px !important;
	}
</style>


<div class="postpg">
<p>
	<a href="/"> << Back to Index </a>
</p>

<h2>[六省联考2017]分手是祝愿</h2>
<div id="post">
	<span style="color:#159957">In Categories:</span>
	
    	<span>解题报告</span>
    

    <br/>
    <span style="color:#159957">In Tags:</span>
    
    	<span>期望  贪心</span>
    
	<p>
    	<p>上午做了六省联考2017 Day2.</p>

<p>挂的一塌糊涂，除了某个做过的题 A 了之外其他题目加起来只有55. 这个题目的贪心都没想到。</p>

<p>cxy神犇接近AK。</p>

<p>技不如人， 如果不多刷题的话， 可能只有失败的后果吧。</p>

<p>现在也不要想别的了，挂了就是自己弱， 没别的。 就是自己弱。太弱了，就没有大学上了。</p>

<p>去除杂念， 专心刷题， 才有可能超越啊。</p>

<h2 id="思路">思路</h2>

<p>我们考虑50分的情况。</p>

<blockquote>
  <p>对于50%的数据, 满足 <script type="math/tex">n = k</script>.</p>
</blockquote>

<p><script type="math/tex">n = k</script> , 说明求期望变成了求最小步数。打个暴力可以发现, 最小步数一定小于 <script type="math/tex">n</script> .  为什么呢? 我们考虑构造一个方案来达到最小的步数。每个数的约数小于等于它本身，于是我们贪心地从右边往左边扫，每次碰到一个亮着的灯就按按钮。我们注意到，由于异或的定义，每个按钮最多按一次。所以总次数小于 <script type="math/tex">n</script>， 一定是可行解。如何证明其最优性？如果某个灯本来是亮的，可以分2种情况。由于它必须最后被按灭，要么它在扫到它之前就灭了，要么它在扫到它的时候被按灭。前者说明一次按灭了大于等于2个灯，贪心的答案不会更坏。后者也不会使得答案劣于最优解。如果某个灯是灭的，在按比它编号大的按钮的时候被点亮，我们可以发现，按比它编号大的按钮，一定是由于那个灯是亮的，因此不得不按。最优解不可能比当前贪心策略更好。</p>

<p>这种贪心实际上可以得到80分。</p>

<p>以上都还没有涉及到期望。我们现在来加入 <script type="math/tex">n \neq k</script> 的情况，这就需要建立期望的递推关系。</p>

<p>真的需要把当前的状态塞进期望递推式吗？<strong>动态规划和递推的状态设计，要看转移的需要</strong>。如果转移不需要完整的局面，就没必要把完整的局面塞进递推。显然，如果设每个开关 <script type="math/tex">i</script> 至少还需要按的次数为 <script type="math/tex">x_i</script> ，那么一定有 <script type="math/tex">x_i \in \{ 0, 1 \}</script>. 考虑当前全部开关加起来还需要按 <script type="math/tex">t</script> 次才能清零。这可以看做有 <script type="math/tex">t</script> 个 1 装在 <script type="math/tex">t</script> 个盒子里面，其他的盒子为空。任意取走某一个 1 ，此后的步数减少 1 ；往没有 1 的盒子里面放一个 1 ，此后的步数增加 1.</p>

<p>可以看出，转移只和全部开关加起来要按的次数有关。</p>

<p>设 <script type="math/tex">a_i</script> 表示当前还有 <script type="math/tex">i</script> 个 1 的情况下期望按多少次能全部按成0.此处的 <script type="math/tex">i</script> 就是刚才的 <script type="math/tex">t</script> .</p>

<p>于是：  <br />
​  <br />
<script type="math/tex">% <![CDATA[
\begin{equation}
a_i = 
\begin{cases}
i & 当 i \le k \\
1 + \frac{n - i}{n} \cdot a_{i+1} + \frac{i}{n} \cdot a_{i-1} & 当 i > k 
\end{cases}
\end{equation} %]]></script></p>

<p>这可以高斯消元求解。但是 <script type="math/tex">n \le 10^5</script> ，时间无法承受。</p>

<p>《训练指南》上面的 2 个关于马尔科夫过程的题，一个是高斯消元法，一个是手动消元。这里是不是可以手动消元呢？想想数学课上，学数列的时候，遇到这种式子常常移项差分。试一试：
​  <br />
<script type="math/tex">% <![CDATA[
\begin{align*}
\text{Let }b_i &= a_{i+1} - a_i \\
\Rightarrow b_i &= \frac{i \cdot b_{i-1} - n}{n - i}(i > k)
\end{align*} %]]></script></p>

<p>就可以一个一个递推了。</p>

<p>边界的处理？<script type="math/tex">b_k</script> 是不符合递推式的断点，怎么办？</p>

<p>换一边来推！  <br />
<script type="math/tex">% <![CDATA[
\begin{align*}
b_i &= \frac{i \cdot b_{i-1} - n}{n - i}(i > k) \\
\Rightarrow b_{i-1} &= \frac{(n-i)b_i+n}{i}(i > k) \\
\Rightarrow b_{i} &= \frac{(n - i - 1)b_{i+1}+n}{i+1}(i \ge k)
\end{align*} %]]></script>
结合 <script type="math/tex">b_{n-1} = 1</script> 这一结论（所有盒子里面都有 1 ，任意摸一个都可以减少一步），又有 <script type="math/tex">% <![CDATA[
\forall i < k, b_i = 1 %]]></script> ，可以得出答案。</p>

<p><em>疑问：题中给出的状态，不一定可达</em> <script type="math/tex">b_{n-1}</script> <em>，为何可以这么递推？</em></p>

<p>好像想通了…… <script type="math/tex">b_{n-1}</script> 只是递推的起点，我们要根据初始状态的最少步数来确定取 <script type="math/tex">{b_n}</script> 的哪一项。</p>

<p>考虑差分出的 <script type="math/tex">b_i</script> 的组合意义：从剩下 <script type="math/tex">i+1</script> 步到 <script type="math/tex">i</script> 步的期望操作数目。</p>

<!--more-->

<h2 id="代码">代码</h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">int64</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span> <span class="o">=</span> <span class="mf">1e5</span><span class="p">,</span> <span class="n">MOD</span> <span class="o">=</span> <span class="mi">100003</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">ans</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="n">MAXN</span><span class="o">+</span><span class="mi">10</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">MAXN</span><span class="o">+</span><span class="mi">10</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="n">MAXN</span><span class="o">+</span><span class="mi">10</span><span class="p">];</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">vec</span><span class="p">[</span><span class="n">MAXN</span><span class="o">+</span><span class="mi">10</span><span class="p">];</span>

<span class="kr">inline</span> <span class="kt">int</span> <span class="nf">mod_mul</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">((</span><span class="n">int64</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">%</span> <span class="n">MOD</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">int64</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">%</span> <span class="n">MOD</span><span class="p">))</span> <span class="o">%</span> <span class="n">MOD</span><span class="p">;</span> <span class="p">}</span>

<span class="kr">inline</span> <span class="kt">int</span> <span class="nf">fastpow</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">mod_mul</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>
        <span class="n">x</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">mod_mul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">k</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="n">A</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
            <span class="n">vec</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="k">if</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">{</span>
        <span class="o">++</span><span class="n">cnt</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="kt">int</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">());</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
            <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">vec</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
            <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">^=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">b</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span>
        <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mod_mul</span><span class="p">(</span><span class="n">mod_mul</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="n">fastpow</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">MOD</span><span class="o">-</span><span class="mi">2</span><span class="p">));</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span>
        <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">cnt</span><span class="p">];</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">mod_mul</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="n">ans</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>


	</p>
</div>
<div id="related">
    <h3>Related Posts:</h3>
    <ul class="posts" style="margin:0px; padding:0px;">
        
    		<li><a href="/2018/03/17/ISAP">ISAP算法学习笔记</a></li>
  	  	
    		<li><a href="/2018/03/15/walk">[HNOI2013]游走</a></li>
  	  	
    		<li><a href="/2018/03/14/greeting">[六省联考2017]相逢是问候</a></li>
  	  	
    </ul>
</div>
<div id="comment">
     
	<h3>Comments:</h3>
<div id="comm1"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
var gitment = new Gitment({
  id: '/2018/03/13/wish',
  owner: 'panda2134',
  repo: 'panda2134.github.io',
  oauth: {
    client_id: '9107291a3086ed30c48f',
    client_secret: 'aaa7ae9353eca07778c747e5641ffa81c5c24e8d',
  },
});
gitment.render('comm1');
</script>
	<noscript>Please enable JavaScript to view the comments.</noscript>
	
</div>
</div>


      <footer class="site-footer">
        
          <span class="site-footer-owner"><a href="http://github.com/panda2134/panda2134.github.io">panda2134.github.io</a> is maintained by <a href="http://github.com/panda2134">panda2134</a>.</span>
        
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
      </footer>
    </section>

    
  </body>
</html>
